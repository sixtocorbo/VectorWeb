@using Microsoft.AspNetCore.Components.Authorization
@using VectorWeb.Auth
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager Navegador

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="">Vector</a>
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable" onclick="document.querySelector('.navbar-toggler').click()">
    <nav class="flex-column">
        <AuthorizeView>
            <Authorized Context="authContext">
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="documentos">
                        <span class="bi bi-documentos-nav-menu" aria-hidden="true"></span> Documentos
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="documentos/vinculacion">
                        <span class="bi bi-vinculacion-nav-menu" aria-hidden="true"></span> Vinculación
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="reclusos">
                        <span class="bi bi-people-nav-menu" aria-hidden="true"></span> Reclusos
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="renovaciones">
                        <span class="bi bi-art120-nav-menu" aria-hidden="true"></span> Art. 120
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="configuracion/oficinas">
                        <span class="bi bi-oficinas-nav-menu" aria-hidden="true"></span> Oficinas
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="configuracion/tipos-documento">
                        <span class="bi bi-tipos-documento-nav-menu" aria-hidden="true"></span> Tipos de Documento
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="configuracion/estados">
                        <span class="bi bi-estados-nav-menu" aria-hidden="true"></span> Estados
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="configuracion/rangos">
                        <span class="bi bi-rangos-nav-menu" aria-hidden="true"></span> Rangos
                    </NavLink>
                </div>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="configuracion/usuarios">
                        <span class="bi bi-people-fill" aria-hidden="true"></span> Usuarios y Roles
                    </NavLink>
                </div>
                <div class="nav-item px-3 mt-4">
                    <div class="text-white small px-3">
                        Usuario: <strong>@authContext.User.Identity?.Name</strong>
                    </div>
                    <button class="btn btn-link nav-link text-warning" @onclick="CerrarSesion">
                        <i class="bi bi-box-arrow-left"></i> Salir
                    </button>
                </div>
            </Authorized>
            <NotAuthorized>
                <div class="nav-item px-3">
                    <NavLink class="nav-link" href="login">
                        <span class="bi bi-person-lock" aria-hidden="true"></span> Iniciar Sesión
                    </NavLink>
                </div>
            </NotAuthorized>
        </AuthorizeView>
    </nav>
</div>

@code {
    private async Task CerrarSesion()
    {
        if (AuthStateProvider is CustomAuthStateProvider auth)
        {
            await auth.MarkUserAsLoggedOutAsync();
        }

        Navegador.NavigateTo("/login");
    }
}
